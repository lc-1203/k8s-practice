# K8S安装篇
- [1. K8S集群搭建方式](#1-k8s集群搭建方式)
- [2. 一次性安装成功原则（流程）](#2-一次性安装成功原则流程)
  - [2.1. 安装及优化部分](#21-安装及优化部分)
  - [2.2. 集群建立部分](#22-集群建立部分)
  - [2.3. Addons插件安装](#23-addons插件安装)
  - [2.4. 收尾工作](#24-收尾工作)
  - [2.5. 后期维护](#25-后期维护)
- [3. 集群网段划分原则](#3-集群网段划分原则)
- [4. 服务器选型](#4-服务器选型)
- [5. K8S版本选型](#5-k8s版本选型)
## 1. K8S集群搭建方式

- kubeadm
- 二进制
- Ansible自动化部署
- sealyun软件（付费）

## 2. 一次性安装成功原则（流程）

### 2.1. 安装及优化部分

- 基本环境配置及优化
- 安装Runtime（Docker、Containerd）
- K8S组件
  - kubeadm方式：Kubeadm&Kubelet
  - 二进制：K8s组件及ETCD安装
- 高可用实现

### 2.2. 集群建立部分

- 集群证书（kubeadm跳过）
- Master节点
- Node节点
- CNI插件安装

### 2.3. Addons插件安装

- Metrics Server
- Dashboard
- CoreDNS（kubeadm默认已安装）

### 2.4. 收尾工作

- 集群可用性验证，kube-bench
- 生产必备配置

### 2.5. 后期维护

- 证书续签
- 备份、迁移

## 3. 集群网段划分原则

搭建K8S集群时，需提前规划好主机地址、Kubernetes Pod地址和Service地址，合理设计应用部署模型和网络访问方式。

- 主机节点网段：192.168.1.0/24
- Service网段：10.96.0.0/16
- Pod网段：10.244.0.0/16

> [在线IP地址/子网掩码计算与转换工具](http://tools.jb51.net/aideddesign/ip_net_calc/)

> 注：公有云厂商的网络插件可以直接给容器分配主机同网段IP，即POD与主机处于同一VPC，无NAT损耗

## 4. 服务器选型

模拟测试建议使用阿里云-抢占式示例，张家口区域【2C4G+20G】仅0.04元/小时，停机0.01元/每小时。

性价比实例推荐：计算网络增强型 sn1ne，通用网络增强型 sn2ne

> 生产环境建议docker、etcd分别使用独立数据盘

## 5. K8S版本选型

生产环境K8S版本建议大版本最好次新及以下，小版本5以上